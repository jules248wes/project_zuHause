<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Customer Service Details Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../zuHause/wwwroot/css/admin-common.css">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .main-content {
            padding-top: 2rem;
        }
        .card-header {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container-fluid main-content">
        <h1 class="h3 mb-4">客服案件詳情</h1>

        <div class="row">
            <!-- Left Column: Conversation Area -->
            <div class="col-lg-8">
                <!-- User Request Content Card -->
                <div class="card mb-4">
                    <div class="card-header">
                        使用者需求內容
                    </div>
                    <div class="card-body">
                        <p><strong>主旨：</strong> 關於房源 #P12345 的租金問題</p>
                        <p>你好，</p>
                        <p>我對房源 #P12345 很感興趣，但網站上標示的租金為每月 $35,000，而我在其他地方看到似乎是 $32,000。請問哪一個才是正確的？另外，請問租金是否包含管理費和網路費用？</p>
                        <p>期待您的回覆，謝謝。</p>
                        <small class="text-muted">發送時間: 2024-07-13 10:30 AM</small>
                    </div>
                </div>

                <!-- Customer Service Reply Card -->
                <div class="card">
                    <div class="card-header">
                        客服回覆區
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="replyContent" class="form-label">回覆內容</label>
                            <textarea class="form-control" id="replyContent" rows="8" placeholder="請在此輸入回覆..."></textarea>
                        </div>
                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#templateModal">
                                <i class="bi bi-journal-plus"></i> 插入模板
                            </button>
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#confirmReplyModal">
                                <i class="bi bi-chat-right-text-fill"></i> 送出回覆
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Case Info & Management -->
            <div class="col-lg-4">
                <!-- Case Information Card -->
                <div class="card mb-4">
                    <div class="card-header">
                        案件資訊
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                客服單號
                                <span>CS-20240713-001</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                案件狀態
                                <span class="badge text-bg-warning">處理中</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                申請會員
                                <a href="#">王大明 (M000123)</a>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                關聯項目
                                <a href="#">房源ID: P12345</a>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                申請時間
                                <span>2024-07-13 10:30</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                最後回覆時間
                                <span>-</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Case Management Card -->
                <div class="card">
                    <div class="card-header">
                        案件管理
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">處理人員</label>
                            <input type="text" class="form-control" value="Admin_User_01" readonly>
                        </div>
                        <div class="mb-3">
                            <label for="statusChange" class="form-label">變更狀態</label>
                            <select class="form-select" id="statusChange" onchange="if(this.value) {$('#confirmStatusChangeModal').modal('show');}">
                                <option value="">選擇新狀態...</option>
                                <option value="pending">待處理</option>
                                <option value="in_progress">處理中</option>
                                <option value="replied">已回覆</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Confirm Reply Modal -->
    <div class="modal fade" id="confirmReplyModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">確認送出回覆</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>即將送出您的回覆，並將此案件狀態更新為「已回覆」。</p>
                    <p><strong>此操作無法復原，確定要繼續嗎？</strong></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary">確認送出</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirm Status Change Modal -->
    <div class="modal fade" id="confirmStatusChangeModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">確認變更狀態</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>您確定要將案件狀態變更為 <strong id="newStatusText"></strong> 嗎？</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="$('#statusChange').val('');">取消</button>
                    <button type="button" class="btn btn-danger">確認變更</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Insert Template Modal -->
    <div class="modal fade" id="templateModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">選擇回覆模板</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="list-group">
                        <a href="#" class="list-group-item list-group-item-action" onclick="selectTemplate('template1')">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">模板一：租金問題通用回覆</h6>
                            </div>
                            <p class="mb-1 small">親愛的用戶，感謝您的詢問。關於租金問題...</p>
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" onclick="selectTemplate('template2')">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">模板二：預約看房回覆</h6>
                            </div>
                            <p class="mb-1 small">我們已收到您的預約看房申請，將會有專人與您聯繫...</p>
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" onclick="selectTemplate('template3')">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">模板三：帳號問題通用回覆</h6>
                            </div>
                            <p class="mb-1 small">關於您的帳號問題，請您提供更詳細的資訊...</p>
                        </a>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        // Dummy function to simulate template insertion
        function selectTemplate(templateId) {
            const templates = {
                template1: '親愛的用戶，感謝您的詢問。關於您提到的租金問題，我們網站上所標示的價格均為最新且最準確的資訊。租金已包含管理費，但不包含網路費用，網路需由承租方自行申請。希望這個回覆能幫助到您！',
                template2: '親愛的用戶，我們已收到您的預約看房申請，專員將會在 24 小時內透過電話與您聯繫，確認詳細時間與細節，請您留意來電。',
                template3: '親愛的用戶，關於您的帳號問題，為了更好地協助您，請您提供註冊時使用的 Email 或手機號碼，以便我們為您查詢。'
            };
            $('#replyContent').val(templates[templateId]);
            $('#templateModal').modal('hide');
        }

        // Update status change modal text
        $('#confirmStatusChangeModal').on('show.bs.modal', function () {
            var status = $('#statusChange option:selected').text();
            $('#newStatusText').text(status);
        });
    </script>
</body>
</html>
