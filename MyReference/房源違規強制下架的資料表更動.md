# 房源違規強制下架的資料表更動

當房源因違規被強制下架時，會涉及以下資料表的更動。

---

## 强制下架流程

### 1. `properties` 表

- **`statusCode`**: 直接更新為 `'BANNED'`。
- **保持不變的欄位**:
  - `publishedAt`: 保留原發布時間。
  - `propertyProofURL`: 保持不變。
  - `isPaid`: 付費狀態保持不變。
  - `expireAt`: 過期時間保持不變。

### 2. `approvals` 表

- **不做任何更動**。
- 維持其歷史審核狀態（通常是 `APPROVED`），以保持審核記錄的完整性。

### 3. `approvalItems` 表

- **新增一筆強制下架操作記錄**:
  - `actionType`: 設為 `'FORCE_BANNED'`。
  - `actionBy`: 記錄執行此操作的管理員 `adminID`。
  - `actionNote`: 記錄違規原因和下架理由。
  - `snapshotJSON`: 記錄下架時的房源狀態快照。

---

## 重新上架流程

當房東修正違規內容後，重新申請上架的流程如下：

### 1. `approvals` 表

- **`statusCode`**: 重置為 `'PENDING'`。

### 2. `properties` 表

- **`statusCode`**: 透過觸發器（Trigger）自動同步 `approvals` 表的狀態，更新為 `'PENDING'`。

### 3. `approvalItems` 表

- **新增一筆重新申請記錄**:
  - `actionType`: 設為 `'SUBMIT'`。
