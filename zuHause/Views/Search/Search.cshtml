@{
	ViewData["Title"] = "房屋搜尋";
}

@section Styles {
	<link rel="stylesheet" href="~/css/Search.css" asp-append-version="true" />
}

<div class="container main-content">

	<div class="search-bar-container mb-4">
		<div class="input-group">
			<select class="form-select" id="citySelect" aria-label="城市選擇">
				<option value="" disabled selected>載入城市...</option>
			</select>
			<input type="text" class="form-control" id="keywordSearch" placeholder="請輸入關鍵字 (社區名、街道名、捷運名稱等)">
			<button class="btn btn-primary" type="button" id="searchButton">搜尋</button>
		</div>
	</div>

	<div class="filters-container">
		<div class="row g-3">
			@* 使用 row 和 g-3 (gap) 保持間距 *@

			<div class="col-12 filter-group d-flex align-items-baseline flex-wrap">
				@* 使用 align-items-baseline for better label alignment *@
				<label class="form-label me-2 mb-0">位置</label>
				<div class="btn-group me-2" role="group" aria-label="位置不限">
					<input type="radio" class="btn-check" name="district" id="districtNoLimit" autocomplete="off" checked>
					<label class="btn btn-outline-secondary btn-sm" for="districtNoLimit" data-filter-type="district">不限</label>
				</div>
				<div id="districtCheckboxes" class="d-flex flex-wrap align-items-center">
					@* 確保動態生成的行政區對齊 *@
					@* 行政區複選框將在這裡由 JavaScript 動態插入 *@
				</div>
			</div>

			<div class="col-12 filter-group d-flex align-items-baseline flex-wrap">
				@* align-items-baseline *@
				<label class="form-label me-2 mb-0">租金</label>
				<div class="btn-group me-2" role="group" aria-label="租金不限">
					<input type="radio" class="btn-check" name="rent" id="rentNoLimit" autocomplete="off" checked>
					<label class="btn btn-outline-secondary btn-sm" for="rentNoLimit" data-filter-type="rent">不限</label>
				</div>
				<div class="d-flex align-items-center flex-wrap ms-2">
					<input type="radio" class="btn-check" name="rent" id="rent5k" autocomplete="off" value="0-5000">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="rent5k">5000以下</label>

					<input type="radio" class="btn-check" name="rent" id="rent5-10k" autocomplete="off" value="5000-10000">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="rent5-10k">5000-10000</label>

					<input type="radio" class="btn-check" name="rent" id="rent10-20k" autocomplete="off" value="10000-20000">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="rent10-20k">10000-20000</label>

					<input type="radio" class="btn-check" name="rent" id="rent20-30k" autocomplete="off" value="20000-30000">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="rent20-30k">20000-30000</label>

					<input type="radio" class="btn-check" name="rent" id="rent30-40k" autocomplete="off" value="30000-40000">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="rent30-40k">30000-40000</label>

					<input type="radio" class="btn-check" name="rent" id="rent40kUp" autocomplete="off" value="40000-max">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="rent40kUp">40000以上</label>
				</div>
				<div class="d-flex align-items-center ms-3">
					<input type="number" class="form-control form-control-sm w-auto" id="minRentInput" placeholder="最低價">
					<span class="mx-1">-</span>
					<input type="number" class="form-control form-control-sm w-auto" id="maxRentInput" placeholder="最高價">
					<span class="ms-1">元</span>
				</div>
			</div>

			<div class="col-12 filter-group d-flex align-items-baseline flex-wrap">
				@* align-items-baseline *@
				<label class="form-label me-2 mb-0">格局</label>
				<div class="btn-group me-2" role="group" aria-label="格局不限">
					<input type="radio" class="btn-check" name="layout" id="layoutNoLimit" autocomplete="off" checked>
					<label class="btn btn-outline-secondary btn-sm" for="layoutNoLimit" data-filter-type="layout">不限</label>
				</div>
				<div class="d-flex align-items-center flex-wrap ms-2">
					<input type="checkbox" class="btn-check" id="room1" autocomplete="off" value="1">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="room1">1房</label>
					<input type="checkbox" class="btn-check" id="room2" autocomplete="off" value="2">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="room2">2房</label>
					<input type="checkbox" class="btn-check" id="room3" autocomplete="off" value="3">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="room3">3房</label>
					<input type="checkbox" class="btn-check" id="room4up" autocomplete="off" value="4up">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="room4up">4房以上</label>
				</div>
			</div>

			@* 新增一個衛浴篩選器 *@
			<div class="col-12 filter-group d-flex align-items-baseline flex-wrap">
				<label class="form-label me-2 mb-0">衛浴</label>
				<div class="btn-group me-2" role="group" aria-label="衛浴不限">
					<input type="radio" class="btn-check" name="bathroom" id="bathroomNoLimit" autocomplete="off" checked>
					<label class="btn btn-outline-secondary btn-sm" for="bathroomNoLimit" data-filter-type="bathroom">不限</label>
				</div>
				<div class="d-flex align-items-center flex-wrap ms-2">
					<input type="checkbox" class="btn-check" id="bathroom1" autocomplete="off" value="1">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="bathroom1">1衛</label>
					<input type="checkbox" class="btn-check" id="bathroom2" autocomplete="off" value="2">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="bathroom2">2衛</label>
					<input type="checkbox" class="btn-check" id="bathroom3" autocomplete="off" value="3">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="bathroom3">3衛</label>
					<input type="checkbox" class="btn-check" id="bathroom4up" autocomplete="off" value="4up">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="bathroom4up">4衛以上</label>
				</div>
			</div>

			<div class="col-12 filter-group d-flex align-items-baseline flex-wrap">
				@* align-items-baseline *@
				<label class="form-label me-2 mb-0">樓層</label>
				<div class="btn-group me-2" role="group" aria-label="樓層不限">
					<input type="radio" class="btn-check" name="floor" id="floorNoLimit" autocomplete="off" checked>
					<label class="btn btn-outline-secondary btn-sm" for="floorNoLimit" data-filter-type="floor">不限</label>
				</div>
				<div class="d-flex align-items-center flex-wrap ms-2">
					<input type="radio" class="btn-check" name="floor" id="floor1" autocomplete="off" value="1">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="floor1">1樓</label>
					<input type="radio" class="btn-check" name="floor" id="floor2-6" autocomplete="off" value="2-6">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="floor2-6">2-6樓</label>
					<input type="radio" class="btn-check" name="floor" id="floor6-12" autocomplete="off" value="6-12">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="floor6-12">6-12樓</label>
					<input type="radio" class="btn-check" name="floor" id="floor12up" autocomplete="off" value="12up">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="floor12up">12樓以上</label>
				</div>
			</div>

			<div class="col-12 filter-group d-flex align-items-baseline flex-wrap">
				@* align-items-baseline *@
				<label class="form-label me-2 mb-0">坪數</label>
				<div class="btn-group me-2" role="group" aria-label="坪數不限">
					<input type="radio" class="btn-check" name="areaSize" id="areaNoLimit" autocomplete="off" checked>
					<label class="btn btn-outline-secondary btn-sm" for="areaNoLimit" data-filter-type="areaSize">不限</label>
				</div>
				<div class="d-flex align-items-center flex-wrap ms-2">
					<input type="radio" class="btn-check" name="areaSize" id="area10below" autocomplete="off" value="0-10">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="area10below">10坪以下</label>
					<input type="radio" class="btn-check" name="areaSize" id="area10-20" autocomplete="off" value="10-20">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="area10-20">10-20坪</label>
					<input type="radio" class="btn-check" name="areaSize" id="area20-30" autocomplete="off" value="20-30">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="area20-30">20-30坪</label>
					<input type="radio" class="btn-check" name="areaSize" id="area30-40" autocomplete="off" value="30-40">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="area30-40">30-40坪</label>
					<input type="radio" class="btn-check" name="areaSize" id="area40-50" autocomplete="off" value="40-50">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="area40-50">40-50坪</label>
					<input type="radio" class="btn-check" name="areaSize" id="area50up" autocomplete="off" value="50-max">
					<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="area50up">50坪以上</label>
				</div>
				<div class="d-flex align-items-center ms-3">
					<input type="number" class="form-control form-control-sm w-auto" id="minAreaInput" placeholder="最小坪">
					<span class="mx-1">-</span>
					<input type="number" class="form-control form-control-sm w-auto" id="maxAreaInput" placeholder="最大坪">
					<span class="ms-1">坪</span>
				</div>
			</div>

			@* 以下兩個 filter-group 放在 collapse 區域內 *@
			<div class="collapse" id="moreFilters">
				<div class="row g-3">
					<div class="col-12 filter-group d-flex align-items-baseline flex-wrap">
						@* align-items-baseline *@
						<label class="form-label me-2 mb-0">特色</label>
						<div class="btn-group me-2" role="group" aria-label="特色不限">
							<input type="radio" class="btn-check" name="feature" id="featureNoLimit" autocomplete="off" checked>
							<label class="btn btn-outline-secondary btn-sm" for="featureNoLimit" data-filter-type="feature">不限</label>
						</div>
						<div class="d-flex align-items-center flex-wrap ms-2">
							<input type="checkbox" class="btn-check" id="newBuilt" autocomplete="off" value="新上架">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="newBuilt">新上架</label>
							<input type="checkbox" class="btn-check" id="nearMRT" autocomplete="off" value="近捷運">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="nearMRT">近捷運</label>
							<input type="checkbox" class="btn-check" id="petFriendly" autocomplete="off" value="可養寵物">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="petFriendly">可養寵物</label>
							<input type="checkbox" class="btn-check" id="cookingAllowed" autocomplete="off" value="可開伙">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="cookingAllowed">可開伙</label>
							<input type="checkbox" class="btn-check" id="parking" autocomplete="off" value="有車位">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="parking">有車位</label>
							<input type="checkbox" class="btn-check" id="elevator" autocomplete="off" value="有電梯">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="elevator">有電梯</label>
							<input type="checkbox" class="btn-check" id="balcony" autocomplete="off" value="有陽台">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="balcony">有陽台</label>
							<input type="checkbox" class="btn-check" id="shortTermRent" autocomplete="off" value="可短期租賃">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="shortTermRent">可短期租賃</label>
						</div>
					</div>

					<div class="col-12 filter-group d-flex align-items-baseline flex-wrap">
						@* align-items-baseline *@
						<label class="form-label me-2 mb-0">設備</label>
						<div class="btn-group me-2" role="group" aria-label="設備不限">
							<input type="radio" class="btn-check" name="equipment" id="equipmentNoLimit" autocomplete="off" checked>
							<label class="btn btn-outline-secondary btn-sm" for="equipmentNoLimit" data-filter-type="equipment">不限</label>
						</div>
						<div class="d-flex align-items-center flex-wrap ms-2">
							<input type="checkbox" class="btn-check" id="ac" autocomplete="off" value="冷氣">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="ac">冷氣</label>
							<input type="checkbox" class="btn-check" id="washingMachine" autocomplete="off" value="洗衣機">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="washingMachine">洗衣機</label>
							<input type="checkbox" class="btn-check" id="refrigerator" autocomplete="off" value="冰箱">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="refrigerator">冰箱</label>
							<input type="checkbox" class="btn-check" id="waterHeater" autocomplete="off" value="熱水器">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="waterHeater">熱水器</label>
							<input type="checkbox" class="btn-check" id="gas" autocomplete="off" value="天然瓦斯">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="gas">天然瓦斯</label>
							<input type="checkbox" class="btn-check" id="internet" autocomplete="off" value="網路">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="internet">網路</label>
							<input type="checkbox" class="btn-check" id="tv" autocomplete="off" value="第四台">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="tv">第四台</label>
							<input type="checkbox" class="btn-check" id="bed" autocomplete="off" value="床">
							<label class="btn btn-outline-secondary btn-sm me-1 mb-1" for="bed">床</label>
						</div>
					</div>
				</div>
			</div> @* end of moreFilters collapse *@

		</div> @* end of row g-3 *@

		<div class="text-center mt-3">
			<a class="expand-collapse-btn text-decoration-none" data-bs-toggle="collapse" href="#moreFilters" role="button" aria-expanded="false" aria-controls="moreFilters">
				<span class="collapsed-text">展開篩選 (空間/坪數/樓層/衛浴/格局/特色/設備)</span>
				<span class="expanded-text d-none">收合篩選</span>
				<i class="bi bi-chevron-down"></i>
			</a>
		</div>
	</div>
	
	<div class="col-10 mx-auto">
		<hr class="my-4">
		<div class="d-flex justify-content-between align-items-center mb-3">
			<h5 class="mb-0">搜尋結果</h5>
			@* 這是您的排序按鈕組，使用 .sort-btn class 和 data-屬性 *@
			<div class="btn-group" role="group" aria-label="排序選項">
				<button type="button" class="btn btn-outline-secondary btn-sm sort-btn active" data-sort-field="PublishedAt" data-sort-order="desc">
					@* 注意這裡我預設給了 active class *@
					最新上架 <i class="bi bi-sort-up"></i> @* 初始預設為升序*@
				</button>
				<button type="button" class="btn btn-outline-secondary btn-sm sort-btn" data-sort-field="MonthlyRent" data-sort-order="asc">
					租金 <i class="bi bi-sort-up"></i> @* 初始預設為升序 *@
				</button>
				<button type="button" class="btn btn-outline-secondary btn-sm sort-btn" data-sort-field="Area" data-sort-order="asc">
					坪數 <i class="bi bi-sort-up"></i> @* 初始預設為升序 *@
				</button>
			</div>
		</div>
		<span id="totalResultsCount" class="text-muted me-auto "></span>

		@* 用於動態載入搜尋結果的容器 *@
		<div id="searchResultsContainer" class="mt-3">
			@* 房源卡片將在這裡由 JavaScript 動態插入 *@
		</div>

		@* 分頁導航將在這裡動態生成 *@
		<nav aria-label="Page navigation" class="mt-4">
			<ul class="pagination justify-content-center" id="paginationContainer">
				@* 分頁按鈕將由 JavaScript 動態插入 *@
			</ul>
		</nav>
	</div>
</div>


@section Scripts {
	<script src="~/js/site.js" asp-append-version="true"></script>
	<script src="~/js/Search.js" asp-append-version="true"></script>
}