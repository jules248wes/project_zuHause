<!--https://localhost:7010/Furniture/OrderHistory-->
@{
    Layout = "~/Views/Shared/_NavigationBar.cshtml";
    ViewBag.Title = "租借 / 購買付款查詢";

    var ongoingOrders = ViewBag.OngoingOrders as IEnumerable<dynamic>;
    var completedOrders = ViewBag.CompletedOrders as IEnumerable<dynamic>;
}

<div class="container-fluid mt-4">
    <div class="row">
        <!-- 左側選單 -->
        <div class="col-md-2">
            <h5>會員功能</h5>
            <ul class="list-group">
                <li class="list-group-item active">租借 / 購買付款查詢</li>
                <li class="list-group-item"><a href="/Furniture/ContactRecords">聯繫紀錄</a></li>
                <li class="list-group-item"><a href="/Furniture/RentalCart">購物車</a></li>
            </ul>
        </div>

        <!-- 右側內容 -->
        <div class="col-md-10">
            <h4>進行中的訂單</h4>
            @if (ongoingOrders != null && ongoingOrders.Any())
            {
                @foreach (var order in ongoingOrders)
                {
                    <div class="card mb-3">
                        <div class="card-body">
                            <p>成立日期：@Convert.ToDateTime(order.CreatedAt).ToString("yyyy-MM-dd HH:mm")</p>
                            <p>商品名稱：@order.ProductName × @order.Quantity</p>
                            <span class="badge bg-info text-dark">訂單處理中</span>
                            <a href="#" class="btn btn-sm btn-outline-primary ms-2">訂單已確認</a>
                        </div>
                    </div>
                }
            }
            else
            {
                <p>目前無進行中的訂單。</p>
            }

            <h4 class="mt-5">已完成的訂單</h4>
            @if (completedOrders != null && completedOrders.Any())
            {
                @foreach (var order in completedOrders)
                {
                    <div class="card mb-3 bg-light">
                        <div class="card-body">
                            <p>成立日期：@Convert.ToDateTime(order.CreatedAt).ToString("yyyy-MM-dd HH:mm")</p>
                            <p>商品名稱：@order.ProductNameSnapshot × @order.Quantity</p>
                            <p>租期：@order.RentalStart ~ @order.RentalEnd</p>
                            <span class="badge bg-success">已歸還</span>
                            <a href="#" class="btn btn-sm btn-outline-secondary ms-2">合約下載</a>
                        </div>
                    </div>
                }
            }
            else
            {
                <p>目前無已完成的訂單。</p>
            }

        </div>
    </div>
</div>
