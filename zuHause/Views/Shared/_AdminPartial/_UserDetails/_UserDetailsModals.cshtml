@using zuHause.AdminViewModels
@{
    MemberData memberData = ViewData["MemberData"] as MemberData;
    if (memberData == null)
    {
        return;
    }
}

<!-- 手動驗證身分 Modal -->
<div class="modal fade" id="verifyIdModal" tabindex="-1" aria-labelledby="verifyIdModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="verifyIdModalLabel">
                    <i class="fas fa-user-check me-2"></i>手動驗證身分
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    您正在為會員 <strong>@memberData.MemberName (ID: @memberData.MemberID)</strong> 進行手動身分驗證。
                </div>
                <div class="mb-3">
                    <label for="idNumberInput" class="form-label">身分證字號</label>
                    <input type="text" class="form-control" id="idNumberInput" placeholder="請輸入身分證字號">
                </div>
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    <strong>重要提醒：</strong>此操作將會把會員的身分驗證狀態標記為「已驗證」，並授予其「房東」資格。請確認資料無誤。
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-1"></i>取消
                </button>
                <button type="button" class="btn btn-primary" id="confirmVerifyBtn">
                    <i class="fas fa-check me-1"></i>確定驗證
                </button>
            </div>
        </div>
    </div>
</div>

<!-- 停用帳號 Modal -->
<div class="modal fade" id="deactivateModal" tabindex="-1" aria-labelledby="deactivateModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title" id="deactivateModalLabel">
                    <i class="fas fa-user-times me-2"></i>確認停用帳號
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    您確定要停用會員 <strong>@memberData.MemberName (ID: @memberData.MemberID)</strong> 的帳號嗎？
                </div>
                <p class="text-danger">
                    <i class="fas fa-ban me-2"></i>停用後，該會員將無法登入系統。
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-arrow-left me-1"></i>取消
                </button>
                <button type="button" class="btn btn-danger" id="confirmDeactivateBtn">
                    <i class="fas fa-ban me-1"></i>確定停用
                </button>
            </div>
        </div>
    </div>
</div>

<!-- 身分證檔案查看 Modal -->
<div class="modal fade" id="idDocumentModal" tabindex="-1" aria-labelledby="idDocumentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="idDocumentModalLabel">
                    <i class="bi bi-file-image me-2"></i>身分證檔案檢視
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center">
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        會員 <strong>@memberData.MemberName (ID: @memberData.MemberID)</strong> 上傳的身分證檔案
                    </div>
                    
                    <!-- 模擬身分證檔案顯示區域 -->
                    <div class="border rounded p-4 bg-light" style="min-height: 400px;">
                        <i class="bi bi-file-image fa-5x text-muted mb-3"></i>
                        <p class="text-muted">身分證檔案預覽</p>
                        <p class="small text-muted">（實際應用中這裡會顯示上傳的身分證圖片）</p>
                        <p class="small text-muted">上傳時間：2024-01-20 15:45:00</p>
                        
                        <div class="mt-4">
                            <button class="btn btn-outline-primary me-2">
                                <i class="bi bi-download me-1"></i>下載原始檔案
                            </button>
                            <button class="btn btn-outline-secondary">
                                <i class="bi bi-zoom-in me-1"></i>放大檢視
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x me-1"></i>關閉
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Double Check 確認Modal -->
<div class="modal fade" id="doubleCheckModal" tabindex="-1" aria-labelledby="doubleCheckModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-warning text-dark">
                <h5 class="modal-title" id="doubleCheckModalLabel">
                    <i class="fas fa-exclamation-triangle me-2"></i>最終確認
                </h5>
            </div>
            <div class="modal-body">
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    <strong>重要提醒：</strong>此操作將直接影響會員狀態，請確認您已仔細檢查所有相關資訊。
                </div>
                
                <p class="mb-3" id="doubleCheckMessage">確定要執行此操作嗎？</p>
                
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="confirmCheckbox">
                    <label class="form-check-label fw-bold" for="confirmCheckbox">
                        我已仔細檢查並確認要執行此操作
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-arrow-left me-1"></i>返回檢查
                </button>
                <button type="button" class="btn btn-danger" id="finalConfirmBtn" disabled>
                    <i class="fas fa-check me-1"></i>確定執行
                </button>
            </div>
        </div>
    </div>
</div>

<!-- 發送系統訊息 Modal -->
<div class="modal fade" id="sendMessageModal" tabindex="-1" aria-labelledby="sendMessageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="sendMessageModalLabel">
                    <i class="bi bi-bell me-2"></i>發送系統訊息給 @memberData.MemberName
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>
                    發送對象：<strong>@memberData.MemberName (ID: @memberData.MemberID)</strong>
                </div>
                
                <form id="sendMessageForm">
                    <div class="row g-3">
                        <!-- 訊息標題 -->
                        <div class="col-12">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <label for="userMessageTitle" class="form-label mb-0">訊息標題 <span class="text-danger">*</span></label>
                                <button type="button" class="btn btn-sm btn-outline-info" onclick="openUserTemplateModal()">
                                    <i class="bi bi-file-text"></i> 插入模板
                                </button>
                            </div>
                            <input type="text" class="form-control" id="userMessageTitle" name="userMessageTitle" required maxlength="100">
                            <div class="form-text">最多100個字元</div>
                        </div>

                        <!-- 訊息內容 -->
                        <div class="col-12">
                            <label for="userMessageContent" class="form-label">訊息內容 <span class="text-danger">*</span></label>
                            <textarea class="form-control" id="userMessageContent" name="userMessageContent" rows="8" required maxlength="2000" 
                                      placeholder="請輸入訊息內容，或點擊上方按鈕選擇模板..."></textarea>
                            <div class="form-text">
                                最多2000個字元。支援參數化內容，如：{用戶姓名}、{時間} 等變數標記。
                                <span id="userContentCharCount" class="float-end">0/2000</span>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="showUserMessageConfirmModal()">
                    <i class="bi bi-send-fill"></i> 發送訊息
                </button>
            </div>
        </div>
    </div>
</div>

<!-- 模板選擇 Modal -->
<div class="modal fade" id="userTemplateModal" tabindex="-1" aria-labelledby="userTemplateModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="userTemplateModalLabel">
                    <i class="bi bi-file-text me-2"></i>選擇系統訊息模板
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <input type="text" class="form-control" id="userTemplateSearch" placeholder="搜尋模板標題或內容...">
                </div>
                <div id="userTemplateList" class="list-group" style="max-height: 400px; overflow-y: auto;">
                    <!-- 模板列表將通過 JavaScript 動態載入 -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
            </div>
        </div>
    </div>
</div>

<!-- 確認發送 Modal -->
<div class="modal fade" id="userMessageConfirmModal" tabindex="-1" aria-labelledby="userMessageConfirmModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="userMessageConfirmModalLabel">
                    <i class="bi bi-exclamation-triangle me-2"></i>確認發送訊息
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle me-2"></i>
                    您確定要發送此訊息給 <strong>@memberData.MemberName</strong> 嗎？
                </div>
                <p class="text-muted">
                    <i class="bi bi-info-circle me-2"></i>注意：訊息一旦發送，即不可修改、刪除或撤回。
                </p>
                
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="userConfirmCheckbox">
                    <label class="form-check-label" for="userConfirmCheckbox">
                        我確認要發送此訊息
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" id="userFinalSendBtn" disabled onclick="sendUserMessage()">
                    <i class="bi bi-send-fill"></i> 確認發送
                </button>
            </div>
        </div>
    </div>
</div>