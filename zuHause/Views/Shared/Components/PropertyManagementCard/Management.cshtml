@model zuHause.DTOs.PropertyCardDisplayDto
@{
    var property = Model.Property;
}

<!-- 橫向房源卡片（管理模式） -->
<div class="col-12 mb-4">
    <div class="card property-management-card @Model.CustomCssClass">
        <div class="row g-0">
            <!-- 房源圖片區域（左側） -->
            <div class="col-md-4">
                <div class="property-image position-relative">
                    <img src="@property.ThumbnailUrl" 
                         class="card-img h-100" 
                         alt="@property.Title" 
                         style="object-fit: cover;"
                         onerror="this.src='/images/property-placeholder.jpg'">
                    
                    @if (Model.ShowStatusBadge)
                    {
                        <span class="badge bg-@property.StatusStyle position-absolute top-0 start-0 m-2">
                            @property.StatusDisplayName
                        </span>
                    }
                    
                    @if (property.RequiresAction)
                    {
                        <div class="action-required-badge position-absolute top-0 end-0 m-2">
                            <i class="fas fa-exclamation-circle text-warning fs-5"></i>
                        </div>
                    }

                    @if (property.IsLegacyStatus)
                    {
                        <div class="legacy-status-badge position-absolute bottom-0 start-0 m-2">
                            <small class="badge bg-secondary">過時狀態</small>
                        </div>
                    }
                </div>
            </div>
            
            <!-- 房源內容區域（右側） -->
            <div class="col-md-8">
                <div class="card-body">
                    <!-- 標題與價格 -->
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <h5 class="card-title mb-0 flex-grow-1">@property.Title</h5>
                        <p class="property-price text-primary fw-bold mb-0 ms-3">@property.PriceDisplay</p>
                    </div>
                    
                    <!-- 地址 -->
                    <p class="property-address text-muted mb-3">
                        <i class="fas fa-map-marker-alt me-1"></i>@property.Address
                    </p>
                    
                    <!-- 房源詳細資訊 -->
                    <div class="property-details mb-3">
                        <span class="badge bg-light text-dark me-2">
                            <i class="fas fa-bed me-1"></i>@property.LayoutDisplay
                        </span>
                        @if (property.Area.HasValue)
                        {
                            <span class="badge bg-light text-dark me-2">
                                <i class="fas fa-expand-arrows-alt me-1"></i>@property.AreaDisplay
                            </span>
                        }
                        <span class="badge bg-light text-dark me-2">
                            <i class="fas fa-layer-group me-1"></i>@property.FloorInfo
                        </span>
                        @if (property.IsPaid)
                        {
                            <span class="badge bg-success text-white">
                                <i class="fas fa-check me-1"></i>已付款
                            </span>
                        }
                    </div>
                    
                    @if (Model.ShowStats)
                    {
                        <!-- 房源統計 -->
                        <div class="property-stats mb-3">
                            <small class="text-muted me-3">
                                <i class="fas fa-eye me-1"></i>瀏覽 @property.ViewCount
                            </small>
                            <small class="text-muted me-3">
                                <i class="fas fa-heart me-1"></i>收藏 @property.FavoriteCount
                            </small>
                            <small class="text-muted me-3">
                                <i class="fas fa-file-alt me-1"></i>申請 @property.ApplicationCount
                            </small>
                        </div>
                    }
                    
                    <!-- 時間資訊 -->
                    <div class="property-meta mb-3">
                        <small class="text-muted">
                            <i class="fas fa-calendar-plus me-1"></i>建立於 @property.CreatedAtDisplay
                        </small>
                        @if (property.UpdatedAt.Date != property.CreatedAt.Date)
                        {
                            <small class="text-muted ms-3">
                                <i class="fas fa-clock me-1"></i>更新於 @property.UpdatedAtDisplay
                            </small>
                        }
                        @if (property.ExpireAt.HasValue)
                        {
                            <small class="text-warning ms-3">
                                <i class="fas fa-hourglass-end me-1"></i>到期 @property.ExpireAtDisplay
                            </small>
                        }
                    </div>
                    
                    @if (Model.ShowActions)
                    {
                        <!-- 條件式操作按鈕 -->
                        <div class="card-actions">
                            <!-- 檢視房源（通用功能） -->
                            <a href="/Property/Detail/@property.PropertyId" 
                               class="btn btn-outline-primary btn-sm"
                               title="檢視房源詳細資訊">
                                <i class="fas fa-eye me-1"></i>檢視房源
                            </a>
                            
                            <!-- 編輯功能（IDLE + LISTED） -->
                            @if (property.IsEditable)
                            {
<<<<<<< HEAD
                                <a href="/Property/Edit/@property.PropertyId" 
=======
                                <a href="/property/@property.PropertyId/edit" 
>>>>>>> origin/feature/property-management
                                   class="btn btn-outline-secondary btn-sm"
                                   title="編輯房源資訊">
                                    <i class="fas fa-edit me-1"></i>編輯
                                </a>
                            }
                            
                            <!-- 下架功能（僅LISTED） -->
                            @if (property.IsTakeDownable)
                            {
                                <button class="btn btn-outline-danger btn-sm" 
                                        onclick="confirmTakeDown(@property.PropertyId)"
                                        title="下架房源">
                                    <i class="fas fa-eye-slash me-1"></i>下架
                                </button>
                            }
                            
                            <!-- 補充資料功能（僅REJECT_REVISE） -->
                            @if (property.RequiresDataSupplement)
                            {
                                <a href="/Property/Supplement/@property.PropertyId" 
                                   class="btn btn-warning btn-sm"
                                   title="補充審核要求的資料">
                                    <i class="fas fa-plus-circle me-1"></i>補充資料
                                </a>
                            }
                            
                            <!-- 聯絡客服功能（僅BANNED） -->
                            @if (property.RequiresCustomerService)
                            {
                                <button class="btn btn-info btn-sm" 
                                        onclick="contactCustomerService(@property.PropertyId)"
                                        title="聯絡客服處理封鎖問題">
                                    <i class="fas fa-headset me-1"></i>聯絡客服
                                </button>
                            }
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>